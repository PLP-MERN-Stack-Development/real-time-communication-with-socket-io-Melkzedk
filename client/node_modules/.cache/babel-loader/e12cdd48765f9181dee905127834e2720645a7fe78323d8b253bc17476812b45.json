{"ast":null,"code":"var _jsxFileName = \"D:\\\\PLP MERN ASSIGMENT\\\\WEEK5\\\\real-time-communication-with-socket-io-Melkzedk\\\\client\\\\src\\\\pages\\\\Chat.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, useContext } from 'react';\nimport { AuthContext } from '../context/AuthContext';\nimport { createSocket } from '../socket/socket';\nimport MessageList from '../components/MessageList';\nimport MessageInput from '../components/MessageInput';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Chat() {\n  _s();\n  const {\n    user\n  } = useContext(AuthContext);\n  const [socket, setSocket] = useState(null);\n  const [messages, setMessages] = useState([]);\n  const [typingUsers, setTypingUsers] = useState([]);\n  useEffect(() => {\n    if (!user) return;\n    const s = createSocket({\n      userId: user.id,\n      username: user.username\n    });\n    setSocket(s);\n    s.on('connect', () => {\n      console.log('connected to socket', s.id);\n      s.emit('join', {\n        userId: user.id,\n        username: user.username,\n        room: 'global'\n      });\n    });\n    s.on('message', m => setMessages(prev => [...prev, m]));\n    s.on('typing', ({\n      userId,\n      username\n    }) => {\n      setTypingUsers(t => [...new Set([...t, username])]);\n      // remove after a delay\n      setTimeout(() => setTypingUsers(t => t.filter(u => u !== username)), 2000);\n    });\n    s.on('presence', users => console.log('presence', users));\n    return () => {\n      s.disconnect();\n    };\n  }, [user]);\n  const sendMessage = text => {\n    if (!socket) return;\n    const payload = {\n      room: 'global',\n      fromId: user.id,\n      text\n    };\n    socket.emit('message', payload);\n  };\n  const sendTyping = () => {\n    if (!socket) return;\n    socket.emit('typing', {\n      room: 'global',\n      userId: user.id,\n      username: user.username\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat\",\n    children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Users\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 1\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 1\n    }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n      children: [/*#__PURE__*/_jsxDEV(MessageList, {\n        messages: messages\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 49,\n        columnNumber: 1\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: typingUsers.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [typingUsers.join(', '), \"typing...\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 1\n      }, this), /*#__PURE__*/_jsxDEV(MessageInput, {\n        onSend: sendMessage,\n        onTyping: sendTyping\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 52,\n        columnNumber: 1\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 1\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 43,\n    columnNumber: 1\n  }, this);\n}\n_s(Chat, \"yQTb9KnuxsjAWXR3Ng0zu1qNFg4=\");\n_c = Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useEffect","useState","useContext","AuthContext","createSocket","MessageList","MessageInput","jsxDEV","_jsxDEV","Chat","_s","user","socket","setSocket","messages","setMessages","typingUsers","setTypingUsers","s","userId","id","username","on","console","log","emit","room","m","prev","t","Set","setTimeout","filter","u","users","disconnect","sendMessage","text","payload","fromId","sendTyping","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","join","onSend","onTyping","_c","$RefreshReg$"],"sources":["D:/PLP MERN ASSIGMENT/WEEK5/real-time-communication-with-socket-io-Melkzedk/client/src/pages/Chat.jsx"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { createSocket } from '../socket/socket';\r\nimport MessageList from '../components/MessageList';\r\nimport MessageInput from '../components/MessageInput';\r\nexport default function Chat() {\r\nconst { user } = useContext(AuthContext);\r\nconst [socket, setSocket] = useState(null);\r\nconst [messages, setMessages] = useState([]);\r\nconst [typingUsers, setTypingUsers] = useState([]);\r\nuseEffect(() => {\r\nif (!user) return;\r\nconst s = createSocket({ userId: user.id, username: user.username });\r\nsetSocket(s);\r\ns.on('connect', () => {\r\nconsole.log('connected to socket', s.id);\r\ns.emit('join', { userId: user.id, username: user.username, room:\r\n'global' });\r\n});\r\ns.on('message', (m) => setMessages((prev) => [...prev, m]));\r\ns.on('typing', ({ userId, username }) => {\r\nsetTypingUsers((t) => [...new Set([...t, username])]);\r\n// remove after a delay\r\nsetTimeout(() => setTypingUsers((t) => t.filter((u) => u !== username)),\r\n2000);\r\n});\r\ns.on('presence', (users) => console.log('presence', users));\r\nreturn () => {\r\ns.disconnect();\r\n};\r\n}, [user]);\r\nconst sendMessage = (text) => {\r\nif (!socket) return;\r\nconst payload = { room: 'global', fromId: user.id, text };\r\nsocket.emit('message', payload);\r\n};\r\nconst sendTyping = () => {\r\nif (!socket) return;\r\nsocket.emit('typing', { room: 'global', userId: user.id, username:\r\nuser.username });\r\n};\r\nreturn (\r\n<div className=\"chat\">\r\n<aside>\r\n<h3>Users</h3>\r\n{/* implement Sidebar component showing online users */}\r\n</aside>\r\n<main>\r\n<MessageList messages={messages} />\r\n<div>{typingUsers.length > 0 && <div>{typingUsers.join(', ')}\r\ntyping...</div>}</div>\r\n<MessageInput onSend={sendMessage} onTyping={sendTyping} />\r\n</main>\r\n</div>\r\n);\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}